<!DOCTYPE HTML>
<html  lang="zh" xmlns:th="http://www.thymeleaf.org">
<meta charset="utf-8">
<head th:include="include :: header"></head>
<body class="white-bg">
    <div class="wrapper wrapper-content animated fadeInRight ibox-content">
        <form class="form-horizontal m" id="form-yfgActivity-edit" th:object="${yfgActivity}">
            <input id="id" name="id" th:field="*{id}"  type="hidden">
			<div class="form-group">	
				<label class="col-sm-3 control-label">活动名称：</label>
				<div class="col-sm-8">
					<input id="activityName" name="activityName" th:field="*{activityName}" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">活动内容：</label>
				<div class="col-sm-8">
					<input id="activityContent" name="activityContent" th:field="*{activityContent}" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">原价：</label>
				<div class="col-sm-8">
					<input id="oriPrice" name="oriPrice" th:field="*{oriPrice}" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">价格：</label>
				<div class="col-sm-8">
					<input id="activityPrice" name="activityPrice" th:field="*{activityPrice}" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">活动开始时间：</label>
				<div class="col-sm-8">
					<input id="beginDateStr" name="beginDateStr" th:field="*{beginDateStr}" class="time-input form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">结束时间：</label>
				<div class="col-sm-8">
					<input id="endDateStr" name="endDateStr" th:field="*{endDateStr}" class="time-input form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">活动数量：</label>
				<div class="col-sm-8">
					<input id="activityNum" name="activityNum" th:field="*{activityNum}" class="form-control" type="text">
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">商品图片：</label>
				<div class="col-sm-8">
					<!-- <input id="activityGoodsImg" name="activityGoodsImg" th:field="*{activityGoodsImg}" class="form-control" type="text"> -->
 							<img id="activityGoodsImg" name="activityGoodsImg" value='custom' alt=" " data-address='' height="150" width="150" th:src="(${yfgActivity.activityGoodsImg} == '') ? @{/img/profile.jpg} : @{/profile/avatar/} + ${yfgActivity.activityGoodsImg}"/>
			                 <input type="file" id="chooseImage1" name="file1" >
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">活动图片1：</label>
				<div class="col-sm-8">
					<!-- <input id="activityImgOne" name="activityImgOne" th:field="*{activityImgOne}" class="form-control" type="text"> -->
					 <img id="activityImgOne" name="activityImgOne" value='custom' alt=" " data-address='' height="150" width="150"  th:src="(${yfgActivity.activityImgOne} == '') ? @{/img/profile.jpg} : @{/profile/avatar/} + ${yfgActivity.activityImgOne}"/>
			         <input type="file" id="chooseImage2" name="file2" >
				</div>
			</div>
			<div class="form-group">	
				<label class="col-sm-3 control-label">活动图片2：</label>
				<div class="col-sm-8">
					<!-- <input id="activityImgTwo" name="activityImgTwo" th:field="*{activityImgTwo}" class="form-control" type="text"> -->
					<img id="activityImgTwo" name="activityImgTwo" value='custom' alt=" " data-address='' height="150" width="150" th:src="(${yfgActivity.activityImgTwo} == '') ? @{/img/profile.jpg} : @{/profile/avatar/} + ${yfgActivity.activityImgTwo}"/>
			        <input type="file" id="chooseImage3" name="file3" >
				</div>
			</div>
			
			<div class="form-group">	
				<label class="col-sm-3 control-label">备注：</label>
				<div class="col-sm-8">
					<input id="remarks" name="remarks" th:field="*{remarks}" class="form-control" type="text">
				</div>
			</div>
		</form>
    </div>
    <div th:include="include::footer"></div>
    <script type="text/javascript">
		var prefix = ctx + "model/yfgActivity";
		$("#form-yfgActivity-edit").validate({
			rules:{
				xxxx:{
					required:true,
				},
			},
			focusCleanup: true
		});
		
		function submitHandler() {
	        if ($.validate.form()) {
	          /*   $.operate.save(prefix + "/edit", $('#form-yfgActivity-edit').serialize()); */
	          add();
	        }
	    }
		
		
		function add(){
			
			 /*    var prefix = ctx + "module/yfgActivity"; */
				var prefix = ctx + "model/yfgActivity"
			    console.log("prefix:"+prefix)
			    var form = new FormData(document.getElementById("form-yfgActivity-edit"));
			    $.ajax({  
			        type : 'POST',  
			        url : prefix+"/edit",  
			        data: form,
			        processData:false,
	                contentType:false,
			        success : function(result) {  
			        	console.log(result)
			        	if(result.code=='0'){
			        		/* console.log("导入成功了") */
			        		$.operate.saveSuccess(result);
			        	}else{
			        		$.modal.alertError("错误提示："+result.msg);
			        	
			        	}
			        },  
			        error : function() {  
			        	$.modal.alertError("错误提示：上传失败，请检查网络后重试,上传文件太大");
		
			        }  
			    });
		}
		
		
		$('#chooseImage1').on('change',function(){
	    	var filePath = $(this).val(),         //获取到input的value，里面是文件的路径
	    		fileFormat = filePath.substring(filePath.lastIndexOf(".")).toLowerCase(),
	    		src = window.URL.createObjectURL(this.files[0]); //转成可以在本地预览的格式
	    		
	    	// 检查是否是图片
	    	if( !fileFormat.match(/.png|.jpg|.jpeg/) ) {
	    		error_prompt_alert('上传错误,文件格式必须为：png/jpg/jpeg');
	        	return;  
	        }
	        console.log("五张图片来处理吧");
	    	var imagePath1 = $("#activityGoodsImg")[0].src;  
	    	$('#activityGoodsImg').attr('src',src);   	
	     });
		
		$('#chooseImage2').on('change',function(){
	    	var filePath = $(this).val(),         //获取到input的value，里面是文件的路径
	    		fileFormat = filePath.substring(filePath.lastIndexOf(".")).toLowerCase(),
	    		src = window.URL.createObjectURL(this.files[0]); //转成可以在本地预览的格式
	    		
	    	// 检查是否是图片
	    	if( !fileFormat.match(/.png|.jpg|.jpeg/) ) {
	    		error_prompt_alert('上传错误,文件格式必须为：png/jpg/jpeg');
	        	return;  
	        }
	        console.log("五张图片来处理吧");
	    	var imagePath1 = $("#activityImgOne")[0].src;  
	    	$('#activityImgOne').attr('src',src);   	
	     });
		
		$('#chooseImage3').on('change',function(){
	    	var filePath = $(this).val(),         //获取到input的value，里面是文件的路径
	    		fileFormat = filePath.substring(filePath.lastIndexOf(".")).toLowerCase(),
	    		src = window.URL.createObjectURL(this.files[0]); //转成可以在本地预览的格式
	    		
	    	// 检查是否是图片
	    	if( !fileFormat.match(/.png|.jpg|.jpeg/) ) {
	    		error_prompt_alert('上传错误,文件格式必须为：png/jpg/jpeg');
	        	return;  
	        }
	        console.log("五张图片来处理吧");
	    	var imagePath1 = $("#activityImgTwo")[0].src;  
	    	$('#activityImgTwo').attr('src',src);   	
	     });
	</script>
</body>
</html>
